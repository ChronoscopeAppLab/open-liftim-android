box: 
  id: kofuk/android-build:1.2
  username: $USER_NAME
  password: $PASSWORD
build:
  steps:
    - script:
        name: Agree with Licenses
        code: |
          cat sdk-licenses/android-sdk-license > "${ANDROID_HOME}/licenses/android-sdk-license"
          cat sdk-licenses/android-sdk-preview-license > "${ANDROID_HOME}/licenses/android-sdk-preview-license"
    - script:
        name: Make gradlew executable
        code: |
          chmod +x gradlew
    - script:
        name: Assemble Debug
        code: |
          ./gradlew assembleDebug
  after-steps:
    - wantedly/pretty-slack-notify:
        webhook-url: $SLACK_WEBHOOK_URL
testing:
  steps:
    - script:
        name: Agree with Licenses
        code: |
          cat sdk-licenses/android-sdk-license > "${ANDROID_HOME}/licenses/android-sdk-license"
          cat sdk-licenses/android-sdk-preview-license > "${ANDROID_HOME}/licenses/android-sdk-preview-license"
    - script:
        name: Run JUit test
        code: ./gradlew test
deploy:
  steps:
    - script:
        name: Deploy via DeployGate
        code: |
          chmod +x deploy.sh; ./deploy.sh
